import{u as A,j as e,C as j,k as G,b as p,c as f,F as K,B as v,d as O,a as g,ao as z,I as H,S as w,e as I,f as S,g as C,h as i,X as J,M as q,q as Q,am as $,ap as E,aq as R,r as X,s as W,t as M,v as B,K as Y,ar as Z,as as _,at as ee,o as se,l as te,ah as ae}from"./index-C6ci-s2z.js";import{r as U}from"./vendor-DazevGLP.js";import"./utils-Bh8xMpiq.js";function le({filters:a,onFiltersChange:t,className:m,showFilters:r={property:!0,owner:!0,portfolioManager:!0,area:!0,bedrooms:!0,status:!0,search:!0},placeholder:u="Search..."}){const[d,h]=U.useState(!1),{data:c=[]}=A({queryKey:["/api/properties"]}),{data:N=[]}=A({queryKey:["/api/users"]}),n=N.filter(s=>s.role==="owner"),o=N.filter(s=>s.role==="portfolio-manager"),k=[...new Set(c.map(s=>s.address?.split(",").pop()?.trim()).filter(Boolean))],P=[...new Set(c.map(s=>s.bedrooms).filter(Boolean))].sort((s,l)=>s-l),x=(s,l)=>{const b={...a};l==="all"||l===""||l===void 0?delete b[s]:b[s]=l,t(b)},T=()=>{t({})},y=()=>Object.keys(a).length,D=s=>{const l=a[s];if(!l)return"All";switch(s){case"propertyId":return c.find(F=>F.id===l)?.name||"Unknown Property";case"ownerId":const L=n.find(F=>F.id===l);return L?`${L.firstName} ${L.lastName}`:"Unknown Owner";case"portfolioManagerId":const V=o.find(F=>F.id===l);return V?`${V.firstName} ${V.lastName}`:"Unknown PM";case"bedroomCount":return`${l} bed${l!==1?"s":""}`;case"propertyStatus":return l.charAt(0).toUpperCase()+l.slice(1);default:return l}};return e.jsxs(j,{className:G("mb-6",m),children:[e.jsx(p,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(f,{className:"text-base flex items-center gap-2",children:[e.jsx(K,{className:"h-4 w-4"}),"Filters",y()>0&&e.jsxs(v,{variant:"secondary",className:"text-xs",children:[y()," active"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[y()>0&&e.jsx(O,{variant:"ghost",size:"sm",onClick:T,className:"text-xs",children:"Clear All"}),e.jsx(O,{variant:"ghost",size:"sm",onClick:()=>h(!d),children:d?"Collapse":"Expand"})]})]})}),e.jsxs(g,{className:"pt-0",children:[r.search&&e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(z,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(H,{placeholder:u,value:a.searchTerm||"",onChange:s=>x("searchTerm",s.target.value),className:"pl-10"})]})}),d&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4",children:[r.property&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-muted-foreground mb-1 block",children:"Property"}),e.jsxs(w,{value:a.propertyId?.toString()||"all",onValueChange:s=>x("propertyId",s==="all"?void 0:parseInt(s)),children:[e.jsx(I,{className:"h-8 text-xs",children:e.jsx(S,{placeholder:"All Properties"})}),e.jsxs(C,{children:[e.jsx(i,{value:"all",children:"All Properties"}),c.map(s=>e.jsx(i,{value:s.id.toString(),children:s.name},s.id))]})]})]}),r.owner&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-muted-foreground mb-1 block",children:"Owner"}),e.jsxs(w,{value:a.ownerId||"all",onValueChange:s=>x("ownerId",s==="all"?void 0:s),children:[e.jsx(I,{className:"h-8 text-xs",children:e.jsx(S,{placeholder:"All Owners"})}),e.jsxs(C,{children:[e.jsx(i,{value:"all",children:"All Owners"}),n.map(s=>e.jsxs(i,{value:s.id,children:[s.firstName," ",s.lastName]},s.id))]})]})]}),r.portfolioManager&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-muted-foreground mb-1 block",children:"Portfolio Manager"}),e.jsxs(w,{value:a.portfolioManagerId||"all",onValueChange:s=>x("portfolioManagerId",s==="all"?void 0:s),children:[e.jsx(I,{className:"h-8 text-xs",children:e.jsx(S,{placeholder:"All PMs"})}),e.jsxs(C,{children:[e.jsx(i,{value:"all",children:"All Portfolio Managers"}),o.map(s=>e.jsxs(i,{value:s.id,children:[s.firstName," ",s.lastName]},s.id))]})]})]}),r.area&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-muted-foreground mb-1 block",children:"Area"}),e.jsxs(w,{value:a.area||"all",onValueChange:s=>x("area",s==="all"?void 0:s),children:[e.jsx(I,{className:"h-8 text-xs",children:e.jsx(S,{placeholder:"All Areas"})}),e.jsxs(C,{children:[e.jsx(i,{value:"all",children:"All Areas"}),k.map(s=>e.jsx(i,{value:s,children:s},s))]})]})]}),r.bedrooms&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-muted-foreground mb-1 block",children:"Bedrooms"}),e.jsxs(w,{value:a.bedroomCount?.toString()||"all",onValueChange:s=>x("bedroomCount",s==="all"?void 0:parseInt(s)),children:[e.jsx(I,{className:"h-8 text-xs",children:e.jsx(S,{placeholder:"Any"})}),e.jsxs(C,{children:[e.jsx(i,{value:"all",children:"Any"}),P.map(s=>e.jsxs(i,{value:s.toString(),children:[s," bed",s!==1?"s":""]},s))]})]})]}),r.status&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-muted-foreground mb-1 block",children:"Status"}),e.jsxs(w,{value:a.propertyStatus||"all",onValueChange:s=>x("propertyStatus",s==="all"?void 0:s),children:[e.jsx(I,{className:"h-8 text-xs",children:e.jsx(S,{placeholder:"All"})}),e.jsxs(C,{children:[e.jsx(i,{value:"all",children:"All"}),e.jsx(i,{value:"active",children:"Active"}),e.jsx(i,{value:"inactive",children:"Inactive"})]})]})]})]}),y()>0&&e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Active filters:"}),Object.entries(a).map(([s,l])=>e.jsxs(v,{variant:"secondary",className:"text-xs flex items-center gap-1",children:[D(s),e.jsx(J,{className:"h-3 w-3 cursor-pointer hover:text-destructive",onClick:()=>x(s,void 0)})]},s))]})})]})]})}function re(a="global-filters"){const[t,m]=U.useState(()=>{if(typeof window>"u")return{};try{const r=localStorage.getItem(a);return r?JSON.parse(r):{}}catch{return{}}});return U.useEffect(()=>{try{localStorage.setItem(a,JSON.stringify(t))}catch{}},[t,a]),[t,m]}function ne(a,t,m={}){const{propertyIdField:r="propertyId",ownerIdField:u="ownerId",portfolioManagerIdField:d="portfolioManagerId",areaField:h="area",bedroomCountField:c="bedrooms",statusField:N="status",searchFields:n=["name","title","description"]}=m;return a.filter(o=>{if(t.propertyId&&o[r]!==t.propertyId||t.ownerId&&o[u]!==t.ownerId||t.portfolioManagerId&&o[d]!==t.portfolioManagerId||t.area&&!o[h]?.includes(t.area)||t.bedroomCount&&o[c]!==t.bedroomCount||t.propertyStatus&&o[N]!==t.propertyStatus)return!1;if(t.searchTerm){const k=t.searchTerm.toLowerCase();if(!n.some(x=>o[x]?.toString().toLowerCase().includes(k)))return!1}return!0})}function ue(){const[a,t]=re("property-dashboard-filters"),{data:m,isLoading:r}=A({queryKey:["/api/properties"]}),{data:u=[]}=A({queryKey:["/api/maintenance-issues"]}),{data:d=[]}=A({queryKey:["/api/utility-bills"]}),{data:h}=A({queryKey:["/api/bookings"]}),c=Array.isArray(m)?m:m?.properties||[],N=Array.isArray(h)?h:h?.bookings||[],n=ne(c,a,{propertyIdField:"id",ownerIdField:"ownerId",portfolioManagerIdField:"portfolioManagerId",areaField:"address",bedroomCountField:"bedrooms",statusField:"status",searchFields:["name","address","description"]}),o=n.filter(s=>s.status==="active").length,k=n.filter(s=>s.status==="inactive").length,P=n.reduce((s,l)=>s+(l.capacity||0),0),x=n.length>0?n.reduce((s,l)=>s+(l.rating||4.5),0)/n.length:0,T=s=>u.filter(l=>l.propertyId===s),y=s=>d.filter(l=>l.propertyId===s&&l.paymentStatus==="pending"),D=s=>{const l=new Date;return N.filter(b=>b.propertyId===s&&new Date(b.checkOut)>=l)};return r?e.jsx("div",{className:"min-h-screen flex bg-background",children:e.jsxs("div",{className:"flex-1 flex flex-col lg:ml-0",children:[e.jsx(q,{title:"Property Dashboard"}),e.jsx("main",{className:"flex-1 overflow-auto p-6",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})})]})}):e.jsx("div",{className:"min-h-screen flex bg-background",children:e.jsxs("div",{className:"flex-1 flex flex-col lg:ml-0",children:[e.jsx(q,{title:"Property Dashboard"}),e.jsxs("main",{className:"flex-1 overflow-auto p-6",children:[e.jsx(le,{filters:a,onFiltersChange:t,placeholder:"Search properties...",showFilters:{property:!0,owner:!0,portfolioManager:!0,area:!0,bedrooms:!0,status:!0,search:!0}}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[e.jsxs(j,{children:[e.jsxs(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(f,{className:"text-sm font-medium",children:"Active Properties"}),e.jsx(Q,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(g,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:o}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[k," inactive"]})]})]}),e.jsxs(j,{children:[e.jsxs(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(f,{className:"text-sm font-medium",children:"Total Capacity"}),e.jsx($,{className:"h-4 w-4 text-blue-600"})]}),e.jsxs(g,{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:P}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"guests across all properties"})]})]}),e.jsxs(j,{children:[e.jsxs(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(f,{className:"text-sm font-medium",children:"Average Rating"}),e.jsx(E,{className:"h-4 w-4 text-yellow-600"})]}),e.jsxs(g,{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:x.toFixed(1)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"out of 5.0 stars"})]})]}),e.jsxs(j,{children:[e.jsxs(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(f,{className:"text-sm font-medium",children:"Open Issues"}),e.jsx(R,{className:"h-4 w-4 text-red-600"})]}),e.jsxs(g,{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:u.filter(s=>s.status==="open").length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"maintenance issues"})]})]})]}),e.jsxs(X,{defaultValue:"grid",className:"space-y-4",children:[e.jsxs(W,{children:[e.jsx(M,{value:"grid",children:"Grid View"}),e.jsx(M,{value:"list",children:"List View"}),e.jsx(M,{value:"maintenance",children:"Maintenance Issues"}),e.jsx(M,{value:"utilities",children:"Utility Bills"})]}),e.jsx(B,{value:"grid",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[n.map(s=>e.jsx(ie,{property:s,maintenanceIssues:T(s.id),utilityBills:y(s.id),bookings:D(s.id)},s.id)),n.length===0&&e.jsx("div",{className:"col-span-full text-center py-12 text-muted-foreground",children:"No properties found with current filters"})]})}),e.jsx(B,{value:"list",children:e.jsx(de,{properties:n})}),e.jsx(B,{value:"maintenance",children:e.jsx(ce,{issues:u.filter(s=>n.some(l=>l.id===s.propertyId))})}),e.jsx(B,{value:"utilities",children:e.jsx(oe,{bills:d.filter(s=>n.some(l=>l.id===s.propertyId))})})]})]})]})})}function ie({property:a,maintenanceIssues:t,utilityBills:m,bookings:r}){const[,u]=Y(),d=t.filter(N=>N.status==="open").length,h=m.length,c=r.length;return e.jsxs(j,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(p,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(f,{className:"text-lg",children:a.name}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground mt-1",children:[e.jsx(Z,{className:"h-3 w-3"}),a.address]})]}),e.jsx(v,{variant:a.status==="active"?"default":"secondary",children:a.status})]})}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{className:"text-sm",children:[a.bedrooms," beds"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{className:"text-sm",children:[a.bathrooms," baths"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{className:"text-sm",children:[a.capacity," guests"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"h-4 w-4 text-yellow-500"}),e.jsx("span",{className:"text-sm",children:a.rating||4.5})]})]}),e.jsxs("div",{className:"space-y-2",children:[d>0&&e.jsx("div",{className:"flex items-center justify-between p-2 bg-red-50 dark:bg-red-950 rounded-md",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{className:"h-4 w-4 text-red-600"}),e.jsxs("span",{className:"text-sm text-red-700 dark:text-red-300",children:[d," open issue",d!==1?"s":""]})]})}),h>0&&e.jsx("div",{className:"flex items-center justify-between p-2 bg-yellow-50 dark:bg-yellow-950 rounded-md",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{className:"h-4 w-4 text-yellow-600"}),e.jsxs("span",{className:"text-sm text-yellow-700 dark:text-yellow-300",children:[h," pending bill",h!==1?"s":""]})]})}),c>0&&e.jsx("div",{className:"flex items-center justify-between p-2 bg-green-50 dark:bg-green-950 rounded-md",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{className:"h-4 w-4 text-green-600"}),e.jsxs("span",{className:"text-sm text-green-700 dark:text-green-300",children:[c," upcoming booking",c!==1?"s":""]})]})})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(O,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>u(`/property/${a.id}`),children:[e.jsx(ae,{className:"h-4 w-4 mr-1"}),"Manage"]})})]})]})}function de({properties:a}){return e.jsxs(j,{children:[e.jsx(p,{children:e.jsx(f,{children:"Properties List"})}),e.jsx(g,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left p-2",children:"Name"}),e.jsx("th",{className:"text-left p-2",children:"Location"}),e.jsx("th",{className:"text-left p-2",children:"Bedrooms"}),e.jsx("th",{className:"text-left p-2",children:"Capacity"}),e.jsx("th",{className:"text-left p-2",children:"Rating"}),e.jsx("th",{className:"text-left p-2",children:"Status"})]})}),e.jsx("tbody",{children:a.map(t=>e.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[e.jsx("td",{className:"p-2 font-medium",children:t.name}),e.jsx("td",{className:"p-2 text-sm text-muted-foreground",children:t.address}),e.jsx("td",{className:"p-2 text-sm",children:t.bedrooms}),e.jsx("td",{className:"p-2 text-sm",children:t.capacity}),e.jsx("td",{className:"p-2 text-sm",children:t.rating||4.5}),e.jsx("td",{className:"p-2",children:e.jsx(v,{variant:t.status==="active"?"default":"secondary",children:t.status})})]},t.id))})]})})})]})}function ce({issues:a}){return e.jsxs(j,{children:[e.jsx(p,{children:e.jsx(f,{children:"Maintenance Issues"})}),e.jsx(g,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left p-2",children:"Property"}),e.jsx("th",{className:"text-left p-2",children:"Issue"}),e.jsx("th",{className:"text-left p-2",children:"Priority"}),e.jsx("th",{className:"text-left p-2",children:"Status"}),e.jsx("th",{className:"text-left p-2",children:"Date"})]})}),e.jsx("tbody",{children:a.map(t=>e.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[e.jsx("td",{className:"p-2 font-medium",children:t.propertyName}),e.jsx("td",{className:"p-2 text-sm",children:t.description}),e.jsx("td",{className:"p-2",children:e.jsx(v,{variant:t.urgency==="High"?"destructive":"secondary",children:t.urgency})}),e.jsx("td",{className:"p-2",children:e.jsx(v,{variant:t.status==="open"?"destructive":"default",children:t.status})}),e.jsx("td",{className:"p-2 text-sm",children:new Date(t.reportedDate).toLocaleDateString()})]},t.id))})]})})})]})}function oe({bills:a}){return e.jsxs(j,{children:[e.jsx(p,{children:e.jsx(f,{children:"Utility Bills"})}),e.jsx(g,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left p-2",children:"Property"}),e.jsx("th",{className:"text-left p-2",children:"Bill Type"}),e.jsx("th",{className:"text-right p-2",children:"Amount"}),e.jsx("th",{className:"text-left p-2",children:"Due Date"}),e.jsx("th",{className:"text-left p-2",children:"Status"})]})}),e.jsx("tbody",{children:a.map(t=>e.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[e.jsx("td",{className:"p-2 font-medium",children:t.propertyName}),e.jsx("td",{className:"p-2 text-sm",children:t.billType}),e.jsxs("td",{className:"p-2 text-sm text-right font-medium",children:["à¸¿",parseFloat(t.amount).toLocaleString()]}),e.jsx("td",{className:"p-2 text-sm",children:new Date(t.dueDate).toLocaleDateString()}),e.jsx("td",{className:"p-2",children:e.jsx(v,{variant:t.paymentStatus==="paid"?"default":"destructive",children:t.paymentStatus})})]},t.id))})]})})})]})}export{ue as default};
